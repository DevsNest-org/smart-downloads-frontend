{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///Users/sundayochuko/DevsNest/smart-downloads-frontend/src/app/api/download/tiktok/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport axios from 'axios';\n\nexport async function POST(request: Request) {\n  try {\n    const { url } = await request.json();\n\n    if (!url) {\n      return NextResponse.json(\n        { error: 'URL is required' },\n        { status: 400 }\n      );\n    }\n\n    // Extract the video ID from the URL\n    const videoId = url.split('/video/')[1]?.split('?')[0];\n    if (!videoId) {\n      return NextResponse.json(\n        { error: 'Invalid TikTok URL format' },\n        { status: 400 }\n      );\n    }\n\n    // Get the video information using TikTok's API\n    const apiUrl = `https://api16-normal-c-useast1a.tiktokv.com/aweme/v1/feed/?aweme_id=${videoId}`;\n    const response = await axios.get(apiUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n        'Accept': 'application/json',\n        'Accept-Language': 'en-US,en;q=0.5',\n        'Referer': 'https://www.tiktok.com/',\n        'Cookie': 'tt_webid_v2=6898541410865432105; tt_webid=6898541410865432105;',\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    // Check if we got a valid response\n    if (!response.data?.aweme_list?.[0]?.video?.play_addr?.url_list?.[0]) {\n      console.error('Invalid API response:', response.data);\n      return NextResponse.json(\n        { error: 'Could not find video URL in TikTok response' },\n        { status: 404 }\n      );\n    }\n\n    // Get the video URL\n    const videoUrl = response.data.aweme_list[0].video.play_addr.url_list[0];\n\n    // Download the video\n    const videoResponse = await axios.get(videoUrl, {\n      responseType: 'arraybuffer',\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n        'Accept': 'video/mp4,video/*;q=0.9,*/*;q=0.8',\n        'Accept-Language': 'en-US,en;q=0.5',\n        'Referer': 'https://www.tiktok.com/',\n        'Range': 'bytes=0-',\n      },\n    });\n\n    // Return the video data\n    return new NextResponse(videoResponse.data, {\n      headers: {\n        'Content-Type': 'video/mp4',\n        'Content-Disposition': 'attachment; filename=\"tiktok-video.mp4\"',\n      },\n    });\n  } catch (error) {\n    console.error('Error downloading TikTok video:', error);\n    \n    // Log more detailed error information\n    if (axios.isAxiosError(error)) {\n      console.error('Response data:', error.response?.data);\n      console.error('Response status:', error.response?.status);\n      console.error('Response headers:', error.response?.headers);\n    }\n\n    return NextResponse.json(\n      { \n        error: 'Failed to download video',\n        details: axios.isAxiosError(error) ? {\n          status: error.response?.status,\n          data: error.response?.data,\n        } : error.message\n      },\n      { status: 500 }\n    );\n  }\n} "],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,QAAQ,IAAI;QAElC,IAAI,CAAC,KAAK;YACR,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkB,GAC3B;gBAAE,QAAQ;YAAI;QAElB;QAEA,oCAAoC;QACpC,MAAM,UAAU,IAAI,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,MAAM,IAAI,CAAC,EAAE;QACtD,IAAI,CAAC,SAAS;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,+CAA+C;QAC/C,MAAM,SAAS,CAAC,oEAAoE,EAAE,SAAS;QAC/F,MAAM,WAAW,MAAM,uIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,QAAQ;YACvC,SAAS;gBACP,cAAc;gBACd,UAAU;gBACV,mBAAmB;gBACnB,WAAW;gBACX,UAAU;gBACV,oBAAoB;YACtB;QACF;QAEA,mCAAmC;QACnC,IAAI,CAAC,SAAS,IAAI,EAAE,YAAY,CAAC,EAAE,EAAE,OAAO,WAAW,UAAU,CAAC,EAAE,EAAE;YACpE,QAAQ,KAAK,CAAC,yBAAyB,SAAS,IAAI;YACpD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8C,GACvD;gBAAE,QAAQ;YAAI;QAElB;QAEA,oBAAoB;QACpB,MAAM,WAAW,SAAS,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;QAExE,qBAAqB;QACrB,MAAM,gBAAgB,MAAM,uIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,UAAU;YAC9C,cAAc;YACd,SAAS;gBACP,cAAc;gBACd,UAAU;gBACV,mBAAmB;gBACnB,WAAW;gBACX,SAAS;YACX;QACF;QAEA,wBAAwB;QACxB,OAAO,IAAI,gIAAA,CAAA,eAAY,CAAC,cAAc,IAAI,EAAE;YAC1C,SAAS;gBACP,gBAAgB;gBAChB,uBAAuB;YACzB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QAEjD,sCAAsC;QACtC,IAAI,uIAAA,CAAA,UAAK,CAAC,YAAY,CAAC,QAAQ;YAC7B,QAAQ,KAAK,CAAC,kBAAkB,MAAM,QAAQ,EAAE;YAChD,QAAQ,KAAK,CAAC,oBAAoB,MAAM,QAAQ,EAAE;YAClD,QAAQ,KAAK,CAAC,qBAAqB,MAAM,QAAQ,EAAE;QACrD;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,uIAAA,CAAA,UAAK,CAAC,YAAY,CAAC,SAAS;gBACnC,QAAQ,MAAM,QAAQ,EAAE;gBACxB,MAAM,MAAM,QAAQ,EAAE;YACxB,IAAI,MAAM,OAAO;QACnB,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}